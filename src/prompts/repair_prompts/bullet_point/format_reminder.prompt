Reminder:
 - Please ensure you implement each function carefully and you MUST provide complete implementation of the Rust code.